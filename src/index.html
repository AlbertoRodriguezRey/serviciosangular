<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Serviciosangular</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

  <!-- Quick theme init to avoid flash (runs before Angular boot) -->
  <script>
    (function() {
      try {
        const stored = localStorage.getItem('theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = stored || (prefersDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
      } catch (e) { /* ignore */ }
    })();
  </script>

  <style>
    /* Basic light/dark variables */
    :root[data-theme="light"] {
      --bg: #ffffff;
      --fg: #111827;
      --card-bg: #ffffff;
      --muted: #6b7280;
      --card-border: rgba(0,0,0,0.06);
      --card-shadow: 0 6px 18px rgba(22, 28, 37, 0.08);
      --card-shadow-hover: 0 12px 30px rgba(22, 28, 37, 0.12);
    }
    :root[data-theme="dark"] {
      --bg: #0b1020;
      --fg: #e6eef8;
      --card-bg: #0f1724;
      --muted: #9aa6bf;
      --card-border: rgba(255,255,255,0.04);
      --card-shadow: 0 10px 30px rgba(2,6,23,0.5);
      --card-shadow-hover: 0 20px 40px rgba(2,6,23,0.7);
    }

    html, body {
      background: var(--bg);
      color: var(--fg);
      height: 100%;
      transition: background-color 280ms ease, color 280ms ease;
    }

    /* Toggle button */
    #theme-toggle {
      position: fixed;
      right: 1rem;
      top: 1rem;
      z-index: 1200;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      border: none;
      background: rgba(255,255,255,0.06);
      color: var(--fg);
      cursor: pointer;
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 12px rgba(2,6,23,0.2);
      transition: transform 160ms ease, background-color 220ms ease;
    }

    #theme-toggle:hover { transform: translateY(-2px); }
    #theme-toggle:focus { outline: 2px solid rgba(99,102,241,0.25); }

    /* Make sure content inside app-root adapts */
    app-root { display: block; min-height: 100vh; background: transparent; }
  </style>
</head>
<body>
  <!-- Theme toggle (outside Angular) -->
  <button id="theme-toggle" aria-label="Toggle color theme" title="Toggle light / dark" aria-pressed="false">
    <svg id="theme-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <!-- placeholder; script will set the correct path -->
    </svg>
  </button>

  <app-root></app-root>

  <script>
    (function() {
      const btn = document.getElementById('theme-toggle');
      const icon = document.getElementById('theme-icon');

      const sunPath = '<path d="M12 4V2M12 22v-2M4 12H2M22 12h-2M5.6 5.6 4.2 4.2M19.8 19.8l-1.4-1.4M19.8 4.2 18.4 5.6M5.6 18.4 4.2 19.8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>';
      const moonPath = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>';

      function currentTheme() {
        return document.documentElement.getAttribute('data-theme') || 'light';
      }
      function applyIcon(theme) {
        icon.innerHTML = theme === 'dark' ? moonPath : sunPath;
      }
      function setTheme(theme) {
        const app = document.querySelector('app-root');
        if (app) app.style.opacity = '0.7';
        document.documentElement.setAttribute('data-theme', theme);
        try { localStorage.setItem('theme', theme); } catch(e) {}
        btn.setAttribute('aria-pressed', theme === 'dark' ? 'true' : 'false');
        applyIcon(theme);
        setTimeout(() => { if (app) app.style.opacity = ''; }, 280);
      }

      // Initialize UI
      setTheme(currentTheme());

      btn.addEventListener('click', function() {
        const next = currentTheme() === 'dark' ? 'light' : 'dark';
        setTheme(next);
      });
    })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>